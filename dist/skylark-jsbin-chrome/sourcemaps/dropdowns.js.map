{"version":3,"sources":["dropdowns.js"],"names":["define","$","jsbin","chrome","analytics","dropdownButtons","menuDown","opendropdown","el","nofocus","menu","dropdownOpen","closest","addClass","trigger","openMenu","hash","substring","input","find","length","mobile","focus","setTimeout","select","closedropdown","removeClass","dropdowns","load","mousedown","e","$dropdownLinks","this","preventDefault","mouseup","click","closeMenu","attr","ignoreUp","$body","bind","event","target","fromClick","nodeName","selectMenu","getAttribute","href","hostname","window","location","triggerHandler","open","mouseover"],"mappings":";;;;;;;AAAAA,QACE,iBACC,UACA,WACA,eACD,SAAUC,EAAEC,EAAMC,EAAOC,GAGzB,IAIIC,EADAC,GAAW,EAGf,SAASC,EAAaC,EAAIC,GACxB,IAAIC,EACJ,IAAKR,EAAMS,aAAc,CACvBD,EAAOT,EAAEO,GAAII,QAAQ,SAASC,SAAS,QAAQC,QAAQ,QAEvDV,EAAUW,SAASP,EAAGQ,KAAKC,UAAU,IACrC,IAAIC,EAAQR,EAAKS,KAAK,uBAElBD,EAAME,SAAWlB,EAAMmB,SACzBH,EAAMI,QACNC,WAAW,WACTL,EAAM,GAAGM,UACR,IAELtB,EAAMS,aAAeH,GAIzB,SAASiB,IACPnB,GAAW,EACPJ,EAAMS,eACRN,EAAgBO,QAAQ,SAASc,YAAY,QAAQZ,QAAQ,SAE7DZ,EAAMS,cAAe,GACX,GAmGd,OAAOR,EAAOwB,WACZpB,aAAAA,EACAkB,cAAAA,EACAG,KAzFF,WACEvB,EAAkBJ,EAAE,kCAAkC4B,UAAU,SAAUC,GAUxE,OATAC,EAAeL,YAAY,SACvBxB,EAAMS,cAAgBT,EAAMS,eAAiBqB,MAC/CP,IAEGvB,EAAMS,eACTL,GAAW,EACXC,EAAayB,OAEfF,EAAEG,kBACK,IACNC,QAAQ,WACT,GAAI5B,EAAU,OAAO,IACpB6B,MAAM,WAKP,OAJK7B,IACHF,EAAUgC,UAAUJ,KAAKhB,KAAKC,UAAU,IACxCQ,KAEEnB,GACFL,EAAE+B,KAAKhB,MAAMqB,KAAK,WAAY,GAC9B/B,GAAW,EACJJ,EAAMmB,SAGff,GAAW,EAEXL,EAAE+B,KAAKhB,MAAMqB,KAAK,YAAa,IACxB,KAGTpC,EAAE,eAAekC,MAAM,WACrBjC,EAAMS,cAAe,IAGvB,IAAI2B,GAAW,EACfpC,EAAMqC,MAAMC,KAAK,YAAa,SAAUC,GAClCvC,EAAMS,cACJV,EAAEwC,EAAMC,QAAQ9B,QAAQ,SAASQ,SACnCkB,GAAW,KAGdE,KAAK,gBAAiB,SAAUC,GACjC,GAAIvC,EAAMS,eAAiB2B,IACpBrC,EAAEwC,EAAMC,QAAQ9B,QAAQ,SAASQ,OAEpC,OADAK,KACO,EAGXa,GAAW,IAGb,IAAIK,GAAY,EACZZ,EAAiB9B,EAAE,0CAA0CiC,QAAQ,SAAUJ,GACvD,UAAtBA,EAAEY,OAAOE,WAIbrB,WAAWE,EAAe,GAC1BrB,EAAUyC,WAAWb,KAAKc,aAAa,eAAiBd,KAAKhB,KAAKC,UAAU,IAAMe,KAAKe,MAClFJ,IACCX,KAAKgB,WAAaC,OAAOC,SAASF,UACI,IAApC/C,EAAE+B,MAAMmB,eAAe,WACzBF,OAAOC,SAAWlB,KAAKe,MAGrBf,KAAKc,aAAa,UACpBG,OAAOG,KAAKpB,KAAKe,MAEjBE,OAAOC,SAAWlB,KAAKe,MAI7BJ,GAAY,KACXU,UAAU,WACXtB,EAAeL,YAAY,SAC3BzB,EAAE+B,MAAMnB,SAAS,WAChBgB,UAAU,SAAUC,GACK,UAAtBA,EAAEY,OAAOE,WAGbD,GAAY","file":"../dropdowns.js","sourcesContent":["define([\r\n  \"skylark-jquery\",\r\n   \"./jsbin\",\r\n   \"./chrome\",\r\n   \"./analytics\"\r\n],function ($,jsbin,chrome,analytics) {\r\n  //moved from chrome/navigation.js\r\n\r\n  var \r\n      //dropdownOpen = false,\r\n      onhover = false,\r\n      menuDown = false,\r\n      dropdownButtons;\r\n\r\n  function opendropdown(el, nofocus) {\r\n    var menu;\r\n    if (!jsbin.dropdownOpen) {\r\n      menu = $(el).closest('.menu').addClass('open').trigger('open');\r\n      // $body.addClass('menuinfo');\r\n      analytics.openMenu(el.hash.substring(1));\r\n      var input = menu.find(':text:visible:first');\r\n\r\n      if (input.length && !jsbin.mobile) {\r\n        input.focus();\r\n        setTimeout(function () {\r\n          input[0].select();\r\n        }, 0);\r\n      }\r\n      jsbin.dropdownOpen = el;\r\n    }\r\n  }\r\n\r\n  function closedropdown() {\r\n    menuDown = false;\r\n    if (jsbin.dropdownOpen) {\r\n      dropdownButtons.closest('.menu').removeClass('open').trigger('close');\r\n      // $body.removeClass('menuinfo');\r\n      jsbin.dropdownOpen = false;\r\n      onhover = false;\r\n      /*\r\n      var f = jsbin.panels.focused; // TODO\r\n      if (f && !jsbin.mobile) {\r\n        f.focus();\r\n        if (f.editor) {\r\n          f.editor.focus();\r\n        }\r\n      }\r\n      */\r\n    }\r\n  }\r\n\r\n  function load() {\r\n    dropdownButtons = $('.button-dropdown, .button-open').mousedown(function (e) {\r\n      $dropdownLinks.removeClass('hover');\r\n      if (jsbin.dropdownOpen && jsbin.dropdownOpen !== this) {\r\n        closedropdown();\r\n      }\r\n      if (!jsbin.dropdownOpen) {\r\n        menuDown = true;\r\n        opendropdown(this);\r\n      }\r\n      e.preventDefault();\r\n      return false;\r\n    }).mouseup(function () {\r\n      if (menuDown) return false;\r\n    }).click(function () {\r\n      if (!menuDown) {\r\n        analytics.closeMenu(this.hash.substring(1));\r\n        closedropdown();\r\n      }\r\n      if (menuDown) {\r\n        $(this.hash).attr('tabindex', 0);\r\n        menuDown = false;\r\n        return jsbin.mobile;\r\n      }\r\n\r\n      menuDown = false;\r\n\r\n      $(this.hash).attr('tabindex', -1);\r\n      return false;\r\n    });\r\n\r\n    $('#actionmenu').click(function () {\r\n      jsbin.dropdownOpen = true;\r\n    });\r\n\r\n    var ignoreUp = false;\r\n    jsbin.$body.bind('mousedown', function (event) {\r\n      if (jsbin.dropdownOpen) {\r\n        if ($(event.target).closest('.menu').length) {\r\n          ignoreUp = true;\r\n        }\r\n      }\r\n    }).bind('click mouseup', function (event) {\r\n      if (jsbin.dropdownOpen && !ignoreUp) {\r\n        if (!$(event.target).closest('.menu').length) {\r\n          closedropdown();\r\n          return false;\r\n        }\r\n      }\r\n      ignoreUp = false;\r\n    });\r\n\r\n    var fromClick = false;\r\n    var $dropdownLinks = $('.dropdownmenu a, .dropdownmenu .button').mouseup(function (e) {\r\n      if (e.target.nodeName === 'INPUT') {\r\n        return;\r\n      }\r\n\r\n      setTimeout(closedropdown, 0);\r\n      analytics.selectMenu(this.getAttribute('data-label') || this.hash.substring(1) || this.href);\r\n      if (!fromClick) {\r\n        if (this.hostname === window.location.hostname) {\r\n          if ($(this).triggerHandler('click') !== false) {\r\n            window.location = this.href;\r\n          }\r\n        } else {\r\n          if (this.getAttribute('target')) {\r\n            window.open(this.href);\r\n          } else {\r\n            window.location = this.href;\r\n          }\r\n        }\r\n      }\r\n      fromClick = false;\r\n    }).mouseover(function () {\r\n      $dropdownLinks.removeClass('hover');\r\n      $(this).addClass('hover');\r\n    }).mousedown(function (e) {\r\n      if (e.target.nodeName === 'INPUT') {\r\n        return;\r\n      }\r\n      fromClick = true;\r\n    });\r\n\r\n  }\r\n\r\n  return chrome.dropdowns = {\r\n    opendropdown,\r\n    closedropdown,\r\n    load\r\n  }\r\n});"]}